<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to caRecall • caRecall</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to caRecall">
<meta property="og:description" content="caRecall">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">caRecall</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vrd_vignette.html">Introduction to caRecall</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/WraySmith/caRecall/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vrd_vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to caRecall</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/WraySmith/caRecall/blob/master/vignettes/vrd_vignette.Rmd"><code>vignettes/vrd_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>vrd_vignette.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <code>caRecall</code> package is an API wrapper for the Government of Canada <a href="https://tc.api.canada.ca/en/detail?api=VRDB">Vehicle Recalls Database (VRD)</a> used by the Defect Investigations and Recalls Division for vehicles, tires, and child car seats. The API wrapper provides access to recall summary information searchable by make, model, and year range, as well as detailed recall information searchable by recall number.</p>
<p>This vignette provides an overview of the functions available in <code>caRecall</code> and provides a demonstration of using the package to extract information from the VRD. In addition to <code>caRecall</code>, this vignette makes use of the <a href="https://dplyr.tidyverse.org/">dplyr</a> and <a href="https://ggplot2.tidyverse.org/">ggplot2</a> packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/WraySmith/caRecall">caRecall</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="api-access-key" class="section level2">
<h2 class="hasAnchor">
<a href="#api-access-key" class="anchor"></a>API Access Key</h2>
<p>An API key is required to run the functions in <code>caRecall</code> and query the Vehicle Recalls Database. The key can be acquired at <a href="https://tc.api.canada.ca/en/detail?api=VRDB" class="uri">https://tc.api.canada.ca/en/detail?api=VRDB</a>. The API key can be set in the environment using <code><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv(VRD_API = 'your_API_key_here')</a></code>. Alternatively, instead of setting the API key in the environment, the key can be passed into the <code>caRecall</code> functions as an argument.</p>
</div>
<div id="carecall-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#carecall-functions" class="anchor"></a><code>caRecall</code> Functions</h2>
<p>The <code>caRecall</code> package focuses on querying data from the Vehicle Recalls Database and functions fall into the following categories:</p>
<ul>
<li>Recall summary information</li>
<li>Recall counts</li>
<li>Detailed recall information</li>
</ul>
<div id="recall-summary-information" class="section level3">
<h3 class="hasAnchor">
<a href="#recall-summary-information" class="anchor"></a>Recall Summary Information</h3>
<p>The <code><a href="../reference/recall_by_make.html">recall_by_make()</a></code>, <code><a href="../reference/recall_by_model.html">recall_by_model()</a></code>, <code><a href="../reference/recall_by_years.html">recall_by_years()</a></code>, and <code><a href="../reference/recall_by_number.html">recall_by_number()</a></code> functions all retrieve recall summary information from the VRD based on user search terms. An overview of the search terms and function arguments includes:</p>
<ul>
<li>
<strong>make or model</strong>: List of make, manufacturer, or model depending on the function used to search on. Note that the search terms are not case sensitive.</li>
<li>
<strong>recall_number</strong>: List of recall numbers to search on (however, this is typically unknown unless previous searches have been conducted).</li>
<li>
<strong>start_year and end_year</strong>: The year range of the search can be specified and is based on the manufactured year and not the year a recall occurred. If the argument(s) are left empty, the search will include the start and end of the data available, respectively. Note that a vehicle year is typically a year later than the manufactured year (for example, a 2009 Ford would be entered in the database as being manufactured in 2008). This also means that a recall date may occur prior to the year of a vehicle.</li>
<li>
<strong>limit</strong>: The VRD API default number of items to return for a query is 25. There does not a appear to be a maximum limit associated with the API but all functions in <code>caRecall</code> also default to a limit of 25.</li>
<li>
<strong>partial</strong>: The <code>caRecall</code> functions allow the user to specify if partial matches on the search terms are used or not (for example, “Su” would return “Suzuki”, and “Subaru” matches). Note that if <code>partial = FALSE</code> is used, the number of entries returned by the functions may be less than the count provided by the <code>count</code> functions described in the following section which return counts for all partial matches (and is the default behavior of the VRD API).</li>
<li>
<strong>api_key</strong>: If an API key is not set in the environment, an access key can be passed directly into a function.</li>
</ul>
<p>An example of using <code><a href="../reference/recall_by_model.html">recall_by_model()</a></code> to search for the first five recalls by ‘Ford’ in 1998 would be as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/recall_by_make.html">recall_by_make</a></span><span class="op">(</span><span class="st">"Ford"</span>, start_year <span class="op">=</span> <span class="fl">1998</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 5 x 6</span>
<span class="co">#&gt;   `Recall number` `Manufacturer Na… `Model name` `Make name`  Year `Recall date`</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;             &lt;chr&gt;        &lt;chr&gt;       &lt;int&gt; &lt;date&gt;       </span>
<span class="co">#&gt; 1 1997118         FORD              WINDSTAR     FORD         1998 1997-06-16   </span>
<span class="co">#&gt; 2 1997119         FORD              B SERIES     FORD         1998 1997-06-17   </span>
<span class="co">#&gt; 3 1997124         FORD              WINDSTAR     FORD         1998 1997-06-23   </span>
<span class="co">#&gt; 4 1997165         FORD              MUSTANG      FORD         1998 1997-09-30   </span>
<span class="co">#&gt; 5 1997165         FORD              WINDSTAR     FORD         1998 1997-09-30</span></code></pre></div>
<p>Or if a user wanted to search by manufactured year and return the first 10 entries between 1999 and 2001, <code><a href="../reference/recall_by_years.html">recall_by_years()</a></code> could be used:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/recall_by_years.html">recall_by_years</a></span><span class="op">(</span>start_year <span class="op">=</span> <span class="fl">1999</span>, end_year <span class="op">=</span> <span class="fl">2001</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 x 6</span>
<span class="co">#&gt;    `Recall number` `Manufacturer N… `Model name` `Make name`  Year `Recall date`</span>
<span class="co">#&gt;    &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;       &lt;int&gt; &lt;date&gt;       </span>
<span class="co">#&gt;  1 1993076         MERCEDES-BENZ    300          MERCEDES-B…  2000 1993-05-31   </span>
<span class="co">#&gt;  2 1998048         FORD             F-350 SUPER… FORD         1999 1998-03-25   </span>
<span class="co">#&gt;  3 1998049         FORD             F-350 SUPER… FORD         1999 1998-03-26   </span>
<span class="co">#&gt;  4 1998067         MAZDA            MIATA        MAZDA        1999 1998-04-08   </span>
<span class="co">#&gt;  5 1998069         FORD             SUPER DUTY   FORD         1999 1998-04-08   </span>
<span class="co">#&gt;  6 1998104         FORD             F-350 SUPER… FORD         1999 1998-05-25   </span>
<span class="co">#&gt;  7 1998105         FORD             F-250        FORD         1999 1998-05-25   </span>
<span class="co">#&gt;  8 1998105         FORD             F-350 SUPER… FORD         1999 1998-05-25   </span>
<span class="co">#&gt;  9 1998105         FORD             F-450 SUPER… FORD         1999 1998-05-25   </span>
<span class="co">#&gt; 10 1998105         FORD             F-550 SUPER… FORD         1999 1998-05-25</span></code></pre></div>
</div>
<div id="recall-counts" class="section level3">
<h3 class="hasAnchor">
<a href="#recall-counts" class="anchor"></a>Recall Counts</h3>
<p>The <code><a href="../reference/count_recall_by_make.html">count_recall_by_make()</a></code>, <code><a href="../reference/count_recall_by_model.html">count_recall_by_model()</a></code>, and <code><a href="../reference/count_recall_by_years.html">count_recall_by_years()</a></code> all return the number of recalls available in the VRD based on the search terms. It can be used to quickly get a count of recalls prior to making a query for summary information.</p>
<p>For example, if a user is interesting in first determining the total number of recalls by the manufacturer ‘GOODBABY’ for all products manufactured up to 2008, the <code><a href="../reference/count_recall_by_make.html">count_recall_by_make()</a></code> could be used.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_recall_by_make.html">count_recall_by_make</a></span><span class="op">(</span><span class="st">"GOODBABY"</span>, manufacturer <span class="op">=</span> <span class="cn">TRUE</span>, end_year <span class="op">=</span> <span class="fl">1998</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 1</span>
<span class="co">#&gt;   `Result Count`</span>
<span class="co">#&gt;            &lt;int&gt;</span>
<span class="co">#&gt; 1             47</span></code></pre></div>
</div>
<div id="detailed-recall-information" class="section level3">
<h3 class="hasAnchor">
<a href="#detailed-recall-information" class="anchor"></a>Detailed Recall Information</h3>
<p>The <code><a href="../reference/recall_details.html">recall_details()</a></code> function provides detailed recall information for a specified recall number. The information includes details of what the recall is for (for example, ‘Seats and Restraints’) as well as a description on the reason for the recall. This function can only use a recall number search term and therefore likely requires prior searching using the summary recall functions to determine recall numbers of interest.</p>
<p>Note that each recall number provided to the function results in a separate API call. Accordingly, the rate of API calls is limited to one call per second to stay within the API limit. For example, providing a list of 60 recall numbers to the function would take approximately 1 minute to complete.</p>
<p>For example, if a Ford Windstar with recall number of 1997118 was of interest:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">recall_windstar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recall_details.html">recall_details</a></span><span class="op">(</span><span class="fl">1997118</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">recall_windstar</span><span class="op">)</span><span class="op">)</span> <span class="co"># transpose for readability</span>
<span class="co">#&gt; # A tibble: 15 x 1</span>
<span class="co">#&gt;    `t(recall_windstar)`[,1]                                                     </span>
<span class="co">#&gt;    &lt;chr&gt;                                                                        </span>
<span class="co">#&gt;  1 "1997118"                                                                    </span>
<span class="co">#&gt;  2 "97S69"                                                                      </span>
<span class="co">#&gt;  3 "Light Truck &amp; Van"                                                          </span>
<span class="co">#&gt;  4 "Camionnette et fourgonnette"                                                </span>
<span class="co">#&gt;  5 "WINDSTAR"                                                                   </span>
<span class="co">#&gt;  6 "FORD"                                                                       </span>
<span class="co">#&gt;  7 "27"                                                                         </span>
<span class="co">#&gt;  8 "Seats And Restraints"                                                       </span>
<span class="co">#&gt;  9 "Sièges et dispositifs de retenue"                                           </span>
<span class="co">#&gt; 10 "Safety Mfr"                                                                 </span>
<span class="co">#&gt; 11 "Sécurité - fabricant"                                                       </span>
<span class="co">#&gt; 12 "NOTE: VEHICLES EQUIPPED WITH SECOND ROW BENCH SEATS AND INTEGRATED CHILD SE…</span>
<span class="co">#&gt; 13 "NOTA : Vise les véhicules équipés d’une seconde banquette et du siège intég…</span>
<span class="co">#&gt; 14 "1998"                                                                       </span>
<span class="co">#&gt; 15 "1997-06-16"</span></code></pre></div>
</div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>In this section, several examples will be shown using <code>caRecall</code> to extract and visualize information of interest.</p>
<div id="setup-api-key" class="section level3">
<h3 class="hasAnchor">
<a href="#setup-api-key" class="anchor"></a>Setup API key</h3>
<p>After getting an API access key from <a href="https://tc.api.canada.ca/en/detail?api=VRDB" class="uri">https://tc.api.canada.ca/en/detail?api=VRDB</a>, the key needs to either be set in the environment (as <code>VRD_API</code>) or passed as an argument into each <code>caRecall</code> function.</p>
<p>To check if the VRD API key is in the environment, the following <code>caRecall</code> function can be used:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_vrd_key.html">get_vrd_key</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>If the key is in the environment as <code>VRD_API</code> it will return the key value. If not, the function will return an error that the key is not set. The key can be set in the environment using <code><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv(VRD_API = "YOUR KEY HERE")</a></code>. Once it is set, you should be able to leave the <code>api_key</code> argument empty in a <code>caRecall</code> function call.</p>
</div>
<div id="getting-data-from-the-vrd" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-data-from-the-vrd" class="anchor"></a>Getting Data from the VRD</h3>
<p>Lets say we want to look in the VRD for the companies that had the most recalls with the items they manufactured in the year 2000. Fist we could see how many items manufactured in 2000 were recalled in the database.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_recall_by_years.html">count_recall_by_years</a></span><span class="op">(</span>start_year <span class="op">=</span> <span class="fl">2000</span>, end_year <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 1</span>
<span class="co">#&gt;   `Result Count`</span>
<span class="co">#&gt;            &lt;int&gt;</span>
<span class="co">#&gt; 1           2422</span></code></pre></div>
<p>We could then query the database for the summary information associated with these recalls.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">recall_summary_2000</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recall_by_years.html">recall_by_years</a></span><span class="op">(</span>start_year <span class="op">=</span> <span class="fl">2000</span>, end_year <span class="op">=</span> <span class="fl">2000</span>, limit <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span>
<span class="va">recall_summary_2000</span>
<span class="co">#&gt; # A tibble: 2,422 x 6</span>
<span class="co">#&gt;    `Recall number` `Manufacturer N… `Model name` `Make name`  Year `Recall date`</span>
<span class="co">#&gt;    &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;       &lt;int&gt; &lt;date&gt;       </span>
<span class="co">#&gt;  1 1993076         MERCEDES-BENZ    300          MERCEDES-B…  2000 1993-05-31   </span>
<span class="co">#&gt;  2 1999056         FIAT CHRYSLER A… NEON         CHRYSLER     2000 1999-04-14   </span>
<span class="co">#&gt;  3 1999108         FIAT CHRYSLER A… NEON         CHRYSLER     2000 1999-06-07   </span>
<span class="co">#&gt;  4 1999111         FLEETWOOD        TIOGA        FLEETWOOD    2000 1999-06-08   </span>
<span class="co">#&gt;  5 1999137         POLARIS          SNOWMOBILE   POLARIS      2000 1999-07-26   </span>
<span class="co">#&gt;  6 1999138         MAZDA            MPV          MAZDA        2000 1999-07-27   </span>
<span class="co">#&gt;  7 1999147         MAZDA            MPV          MAZDA        2000 1999-07-30   </span>
<span class="co">#&gt;  8 1999151         GENERAL MOTORS   S10          CHEVROLET    2000 1999-08-16   </span>
<span class="co">#&gt;  9 1999151         GENERAL MOTORS   SONOMA       GMC          2000 1999-08-16   </span>
<span class="co">#&gt; 10 1999155         GENERAL MOTORS   SUNFIRE      PONTIAC      2000 1999-08-19   </span>
<span class="co">#&gt; # … with 2,412 more rows</span></code></pre></div>
<p>Note that we also could have also just set the <code>limit</code> argument to a high enough value that all entries in the database would likely be included in the summary information query; however, this could also result in returning a very large dataset if the number of available entries is very high.</p>
<p>We can count the number of recalls for each company by grouping on the <code>Manufacturer name</code> column and summarizing the count. We’ll only look at manufacturers with recall counts above 50.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts_manu_2000</span> <span class="op">&lt;-</span> <span class="va">recall_summary_2000</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">`Manufacturer Name`</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">tally</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">counts_manu_2000</span>
<span class="co">#&gt; # A tibble: 11 x 2</span>
<span class="co">#&gt;    `Manufacturer Name`      n</span>
<span class="co">#&gt;    &lt;chr&gt;                &lt;int&gt;</span>
<span class="co">#&gt;  1 COACHMEN                70</span>
<span class="co">#&gt;  2 DAIMLERCHRYSLER         66</span>
<span class="co">#&gt;  3 FLEETWOOD               53</span>
<span class="co">#&gt;  4 FORD                   151</span>
<span class="co">#&gt;  5 FREIGHTLINER           189</span>
<span class="co">#&gt;  6 GENERAL MOTORS         239</span>
<span class="co">#&gt;  7 GULF STREAM COACH       56</span>
<span class="co">#&gt;  8 INTERNATIONAL          170</span>
<span class="co">#&gt;  9 MONACO COACH            64</span>
<span class="co">#&gt; 10 PACCAR                  50</span>
<span class="co">#&gt; 11 WINNEBAGO INDUSTRIES    61</span></code></pre></div>
<p>There are 11 manufacturers with greater than 50 recalls for products manufactured in 2000.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb.cols</span> <span class="op">&lt;-</span> <span class="fl">11</span>
<span class="va">mycolors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Set2"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">nb.cols</span><span class="op">)</span>

<span class="va">counts_manu_2000</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">`Manufacturer Name`</span>, y<span class="op">=</span><span class="va">n</span>, fill<span class="op">=</span><span class="va">`Manufacturer Name`</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">mycolors</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">n</span><span class="op">)</span>, vjust<span class="op">=</span><span class="op">-</span><span class="fl">.5</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Recall Count"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,
        axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">250</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Manufactureres with Most Recalls in 2000"</span><span class="op">)</span></code></pre></div>
<p><img src="vrd_vignette_files/figure-html/plot-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We could also look at how many recalls two manufacturers have had compared with each other over the over the last 10 years (2011 to 2020).</p>
<p>We would start by querying the API for entries with the two manufacturers. This time, we’ll just set the limit to be reasonably high instead of checking the count available in the database first.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">manu_comparison_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ford"</span>, <span class="st">"Toyota"</span><span class="op">)</span>
<span class="va">recall_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recall_by_make.html">recall_by_make</a></span><span class="op">(</span><span class="va">manu_comparison_list</span>, start_year <span class="op">=</span> <span class="fl">2011</span>, end_year <span class="op">=</span> <span class="fl">2020</span>, limit <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span>
<span class="va">recall_comparison</span>
<span class="co">#&gt; # A tibble: 1,266 x 6</span>
<span class="co">#&gt;    `Recall number` `Manufacturer N… `Model name` `Make name`  Year `Recall date`</span>
<span class="co">#&gt;    &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;       &lt;int&gt; &lt;date&gt;       </span>
<span class="co">#&gt;  1 2009290         TOYOTA           CAMRY        TOYOTA       2011 2009-10-07   </span>
<span class="co">#&gt;  2 2010366         FORD             EDGE         FORD         2011 2010-10-25   </span>
<span class="co">#&gt;  3 2010439         TOYOTA           SIENNA       TOYOTA       2011 2010-12-13   </span>
<span class="co">#&gt;  4 2010463         FORD             EDGE         FORD         2011 2010-12-23   </span>
<span class="co">#&gt;  5 2010463         FORD             F-150        FORD         2011 2010-12-23   </span>
<span class="co">#&gt;  6 2010463         FORD             F-250 SUPER… FORD         2011 2010-12-23   </span>
<span class="co">#&gt;  7 2010463         FORD             F-350 SUPER… FORD         2011 2010-12-23   </span>
<span class="co">#&gt;  8 2010463         FORD             F-450 SUPER… FORD         2011 2010-12-23   </span>
<span class="co">#&gt;  9 2010463         FORD             F-550 SUPER… FORD         2011 2010-12-23   </span>
<span class="co">#&gt; 10 2011046         FORD             EXPLORER     FORD         2011 2011-01-31   </span>
<span class="co">#&gt; # … with 1,256 more rows</span></code></pre></div>
<p>We can then plot the total amount of recalls for each year grouped by manufacturer.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">recall_comparison</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">`Year`</span>, color <span class="op">=</span> <span class="va">`Make name`</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, size<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2010</span>,<span class="fl">2021</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Recall Count per Year'</span>,
       y <span class="op">=</span> <span class="st">'Annual Count'</span>, 
       color <span class="op">=</span> <span class="st">'Manufacturer'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="vrd_vignette_files/figure-html/plot2-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The plot shows a much lower number of recalls in 2020 for both manufactures; however, this is likely because there has not been sufficient time for recalls to have occurred on more recent products.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nathan Smith, Mitch Harris, Ryan Koenig.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
